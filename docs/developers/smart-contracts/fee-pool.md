# Smart Contract Fee Pool

## Общее описание

**Smart Contract Fee Pool** - механизм, позволяющий пользователям приложения, основанного на контракте,
использовать вызовы контракта за счет баланса пулла, пополняемого кем-то другим. В частности - владельцем
контракта и приложения. Данный механизм позволяет минимизировать порог входа пользователей в приложение,
позволяя исключить этап, на котором для использования контракта пользователю необходимо предварительно
позаботиться о наличии ненулевого баланса в каком-либо ассете, в котором можно оплачивать комиссию.

В частности данная проблема остро проявляется при использовании *ERC20* токенов, где для перевода токена,
пользователю необходимо владеть дополнительным балансом.

## Используемые операции

### Пополнение баланса - `contrtact_fund_fee_pool_operation`

Используя операцию `contrtact_fund_fee_pool_operation` любой пользователь сети имеет возможность пополнить пул
баланса контракта. Данная операция является необратимой - переведенный на пул контракта баланс может быть
израсходован только при вызовах данного контракта, восстановить (отозвать) баланс с пула невозможно.

Пулл контракта может быть пополнен только в Echo.

При наличии ненулевого балана на пуле, запрос [get_required_fees](https://echo-dev.io/developers/apis/database-api/#get_required_feesops-id)
будет возвращать объект, содержащий в себе одним из полей - комисси. Вторым - сумма комиссии, которую необходимо заплатить пользователю. 
В случае доступности пула пользователю - комиссия для оплаты пользователем будет либо равна 0 (в случае наличия полной суммы комиссии), 
либо являться разницей комисси за выолнение и достуных средств на пуле

### Whitelisting и Blacklisting - `contract_whitelist_operation`

Контракт имеет `whitelist` и `blacklist` - списки аккаунтов, редактируемые владельцем контракта. В случае, если
хотя бы один аккаунт добавлен в `whitelist`, отправка транзакций за счет `fee pool` будет доступна только тем
аккаунтам, которые были добавлены в `whitelist`. Если `whitelist` пуст, любой аккаунт сети может воспользоваться
`fee pool` контракта.

Аккаунты, добавленные в `blacklist` не могут бесплатно использовать данный контракт, даже если баланс `fee pool`
больше нуля.

Используя операцию `contract_whitelist_operation` можно добавить аккаунт в один из списков, либо исключить из
обоих. Вызов операции `contract_whitelist_operation` доступ только для владельца контракта - аккаунта,
создавшего данный контракт.

## Используемые методы API

### Получение списков `whitelist` и `blacklist` - `get_contract_whitelist`

Метод `get_contract_whitelist` возвращает как `whitelist`, так и `blacklist` для указанного контракта.

### Получение контракта - `get_contract_fee_pool_balances`

Метод `get_contract_fee_pool_balances` возвращает текущие балансы `fee pool` для указанного контракта.
